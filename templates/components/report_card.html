{# 
  Report Card Component
  
  Usage:
    {% include "components/report_card.html" with report=report %}
    {% include "components/report_card.html" with report=report show_game=True %}
#}

<article class="card card-hover" id="report-{{ report.id }}">
    <div class="card-body">
        <!-- Header -->
        <header class="flex items-start gap-3 mb-3">
            {% if report.author.avatar %}
                <img src="{{ report.author.avatar.url }}" 
                     alt="{{ report.author.get_display_name }}"
                     class="avatar-md">
            {% else %}
                <span class="avatar-md avatar-placeholder">
                    <span class="i-lucide-user"></span>
                </span>
            {% endif %}
            
            <div class="flex-1 min-w-0">
                <div class="flex items-center gap-2">
                    <a href="#" class="font-medium text-gray-900 hover:text-primary-600">
                        {{ report.author.get_display_name }}
                    </a>
                    
                    {% if report.status == 'draft' %}
                        <span class="badge-gray">
                            <span class="i-lucide-pencil text-xs"></span>
                            Brouillon
                        </span>
                    {% endif %}
                </div>
                
                <p class="text-sm text-gray-500">
                    {% if report.published_at %}
                        {{ report.published_at|timesince }}
                    {% else %}
                        {{ report.created_at|timesince }}
                    {% endif %}
                    
                    {% if show_game and report.game %}
                        <span class="mx-1">·</span>
                        <a href="#" class="hover:text-primary-600">
                            {{ report.game.title }}
                        </a>
                    {% endif %}
                </p>
            </div>
        </header>
        
        <!-- Titre -->
        {% if report.title %}
            <h3 class="font-semibold text-gray-900 mb-2">
                <a href="#" class="hover:text-primary-600">
                    {{ report.title }}
                </a>
            </h3>
        {% endif %}
        
        <!-- Contenu (extrait) -->
        <div class="text-gray-600 text-sm line-clamp-4 mb-3 prose-report">
            {{ report.content|truncatewords:50|safe }}
        </div>
        
        <!-- Personnages mentionnés -->
        {% if report.character_appearances.exists %}
            <div class="mb-3">
                <div class="flex flex-wrap gap-2">
                    {% for appearance in report.character_appearances.all|slice:":6" %}
                        <a href="#" 
                           class="inline-flex items-center gap-1 px-2 py-1 bg-gray-100 rounded-full text-xs text-gray-700 hover:bg-gray-200 transition-colors">
                            <span class="i-lucide-at-sign text-gray-400"></span>
                            {{ appearance.character.name }}
                        </a>
                    {% endfor %}
                    
                    {% if report.character_appearances.count > 6 %}
                        <span class="inline-flex items-center px-2 py-1 text-xs text-gray-500">
                            +{{ report.character_appearances.count|add:"-6" }} autres
                        </span>
                    {% endif %}
                </div>
            </div>
        {% endif %}
        
        <!-- Actions -->
        <footer class="flex items-center gap-4 pt-3 border-t border-gray-100">
            <button class="btn-ghost btn-sm text-gray-500">
                <span class="i-lucide-heart"></span>
                <span class="text-xs">12</span>
            </button>
            
            <button class="btn-ghost btn-sm text-gray-500">
                <span class="i-lucide-message-circle"></span>
                <span class="text-xs">3</span>
            </button>
            
            <button class="btn-ghost btn-sm text-gray-500">
                <span class="i-lucide-share"></span>
            </button>
            
            <a href="#" class="btn-ghost btn-sm text-gray-500 ml-auto">
                Lire la suite
                <span class="i-lucide-arrow-right text-xs"></span>
            </a>
        </footer>
    </div>
</article>
