{# 
  Game Card Component
  
  Usage:
    {% include "components/game_card.html" with game=game %}
    {% include "components/game_card.html" with game=game compact=True %}
#}

<article class="card card-hover" id="game-{{ game.id }}">
    <div class="card-body">
        <!-- Header -->
        <header class="flex items-start justify-between gap-3 mb-3">
            <div class="flex-1 min-w-0">
                <h3 class="font-semibold text-gray-900 mb-1">
                    <a href="#" class="hover:text-primary-600">
                        {{ game.title }}
                    </a>
                </h3>
                
                <div class="flex items-center gap-3 text-sm text-gray-500">
                    <!-- Propriétaire -->
                    <span class="flex items-center gap-1">
                        {% if game.owner.avatar %}
                            <img src="{{ game.owner.avatar.url }}" class="avatar-sm">
                        {% else %}
                            <span class="i-lucide-user text-xs"></span>
                        {% endif %}
                        {{ game.owner.get_display_name }}
                    </span>
                    
                    <!-- Système de jeu -->
                    {% if game.game_system %}
                        <span class="flex items-center gap-1">
                            <span class="i-lucide-dice-5 text-xs"></span>
                            {{ game.game_system }}
                        </span>
                    {% endif %}
                </div>
            </div>
            
            <!-- Visibilité -->
            {% if not game.is_public %}
                <span class="badge-gray">
                    <span class="i-lucide-lock text-xs"></span>
                    Privée
                </span>
            {% endif %}
        </header>
        
        <!-- Description -->
        {% if game.description and not compact %}
            <p class="text-gray-600 text-sm line-clamp-2 mb-3">
                {{ game.description }}
            </p>
        {% endif %}
        
        <!-- Stats -->
        <div class="flex items-center gap-4 text-xs text-gray-500">
            <span class="flex items-center gap-1">
                <span class="i-lucide-file-text"></span>
                {{ game.reports.count }} compte-rendu{{ game.reports.count|pluralize }}
            </span>
            
            <span class="flex items-center gap-1">
                <span class="i-lucide-users"></span>
                {{ game.characters.count }} personnage{{ game.characters.count|pluralize }}
            </span>
            
            {% if game.updated_at %}
                <span class="flex items-center gap-1 ml-auto">
                    <span class="i-lucide-clock"></span>
                    {{ game.updated_at|timesince }}
                </span>
            {% endif %}
        </div>
    </div>
    
    <!-- Derniers personnages (optionnel) -->
    {% if not compact and game.characters.exists %}
        <div class="card-footer">
            <p class="text-xs text-gray-500 mb-2">Personnages récents</p>
            <div class="flex -space-x-2">
                {% for character in game.characters.all|slice:":5" %}
                    {% if character.avatar %}
                        <img src="{{ character.avatar.url }}" 
                             alt="{{ character.name }}"
                             title="{{ character.name }}"
                             class="avatar-sm ring-2 ring-white">
                    {% else %}
                        <span class="avatar-sm avatar-placeholder ring-2 ring-white"
                              title="{{ character.name }}">
                            <span class="i-lucide-user text-xs"></span>
                        </span>
                    {% endif %}
                {% endfor %}
                
                {% if game.characters.count > 5 %}
                    <span class="avatar-sm bg-gray-100 text-gray-600 ring-2 ring-white flex items-center justify-center text-xs font-medium">
                        +{{ game.characters.count|add:"-5" }}
                    </span>
                {% endif %}
            </div>
        </div>
    {% endif %}
</article>
